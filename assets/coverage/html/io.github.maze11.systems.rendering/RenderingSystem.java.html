<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>RenderingSystem.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">core</a> &gt; <a href="index.source.html" class="el_package">io.github.maze11.systems.rendering</a> &gt; <span class="el_source">RenderingSystem.java</span></div><h1>RenderingSystem.java</h1><pre class="source lang-java linenums">package io.github.maze11.systems.rendering;

import java.util.LinkedList;
import java.util.List;

import com.badlogic.ashley.core.ComponentMapper;
import com.badlogic.ashley.core.Entity;
import com.badlogic.ashley.core.Family;
import com.badlogic.ashley.systems.SortedIteratingSystem;
import com.badlogic.ashley.utils.ImmutableArray;
import com.badlogic.gdx.Gdx;
import com.badlogic.gdx.graphics.Color;
import com.badlogic.gdx.graphics.OrthographicCamera;
import com.badlogic.gdx.graphics.Texture;
import com.badlogic.gdx.graphics.g2d.BitmapFont;
import com.badlogic.gdx.graphics.g2d.GlyphLayout;
import com.badlogic.gdx.graphics.g2d.SpriteBatch;
import com.badlogic.gdx.graphics.g2d.TextureRegion;
import com.badlogic.gdx.graphics.glutils.ShapeRenderer;
import com.badlogic.gdx.maps.tiled.TiledMap;
import com.badlogic.gdx.maps.tiled.renderers.OrthogonalTiledMapRenderer;
import com.badlogic.gdx.physics.box2d.Box2DDebugRenderer;
import com.badlogic.gdx.physics.box2d.World;
import com.badlogic.gdx.utils.viewport.ScreenViewport;

import io.github.maze11.MazeGame;
import io.github.maze11.assetLoading.AssetId;
import io.github.maze11.components.AnimationComponent;
import io.github.maze11.components.AttendanceCheckerComponent;
import io.github.maze11.components.SpriteComponent;
import io.github.maze11.components.TimerComponent;
import io.github.maze11.components.TransformComponent;
import io.github.maze11.messages.Message;
import io.github.maze11.messages.MessageListener;
import io.github.maze11.messages.MessagePublisher;
import io.github.maze11.messages.MessageType;
import io.github.maze11.messages.ToastMessage;
import io.github.maze11.systems.PiSystem;

/**
 * Responsible for rendering everything in the game world onto the screen. This includes both the
 * tilemap and the entities. Entities are sorted via their sorting order before they are rendered.
 */
public class RenderingSystem extends SortedIteratingSystem {

  private final MazeGame game;

  private final OrthographicCamera worldCamera;
  private final ScreenViewport uiViewport;

  private final OrthogonalTiledMapRenderer mapRenderer;
  private final SpriteBatch worldBatch;
  private final SpriteBatch uiBatch;

  private final ShapeRenderer shapeRenderer;

<span class="nc" id="L57">  private boolean isDebugging = false;</span>
<span class="nc" id="L58">  private Box2DDebugRenderer debugRenderer = null;</span>
<span class="nc" id="L59">  private World debugWorld = null;</span>
<span class="nc" id="L60">  private Texture originTexture = null;</span>

  private final BitmapFont timerFont;
  private final BitmapFont toastFont;

  private final ComponentMapper&lt;SpriteComponent&gt; spriteM;
  private final ComponentMapper&lt;TransformComponent&gt; transformM;
  private final ComponentMapper&lt;AnimationComponent&gt; animM;
  private final ComponentMapper&lt;TimerComponent&gt; timerM;
  private final ComponentMapper&lt;AttendanceCheckerComponent&gt; attendM;

  private final MessageListener messageListener;

<span class="nc" id="L73">  private List&lt;ToastMessage&gt; toasts = new LinkedList();</span>
<span class="nc" id="L74">  private float toastSpacing = 70f;</span>
<span class="nc" id="L75">  private int maxNumToasts = 5;</span>

  public RenderingSystem(
      MazeGame game, OrthographicCamera worldCamera, TiledMap map, MessagePublisher publisher) {
<span class="nc" id="L79">    super(</span>
<span class="nc" id="L80">        Family.all(SpriteComponent.class, TransformComponent.class).get(),</span>
        new RenderOrderComparator());

<span class="nc" id="L83">    this.game = game;</span>
<span class="nc" id="L84">    this.worldCamera = worldCamera;</span>

<span class="nc" id="L86">    this.worldBatch = game.getBatch();</span>
<span class="nc" id="L87">    this.uiBatch = new SpriteBatch();</span>
<span class="nc" id="L88">    this.shapeRenderer = new ShapeRenderer();</span>

<span class="nc" id="L90">    this.uiViewport = new ScreenViewport();</span>

<span class="nc" id="L92">    float unitScale = 1f / 32f;</span>
<span class="nc" id="L93">    this.mapRenderer = new OrthogonalTiledMapRenderer(map, unitScale, worldBatch);</span>

<span class="nc" id="L95">    this.timerFont = new BitmapFont();</span>
<span class="nc" id="L96">    timerFont.setUseIntegerPositions(false);</span>
<span class="nc" id="L97">    timerFont</span>
<span class="nc" id="L98">        .getRegion()</span>
<span class="nc" id="L99">        .getTexture()</span>
<span class="nc" id="L100">        .setFilter(Texture.TextureFilter.Linear, Texture.TextureFilter.Linear);</span>

<span class="nc" id="L102">    this.toastFont = new BitmapFont();</span>
<span class="nc" id="L103">    toastFont.setUseIntegerPositions(false);</span>
<span class="nc" id="L104">    toastFont</span>
<span class="nc" id="L105">        .getRegion()</span>
<span class="nc" id="L106">        .getTexture()</span>
<span class="nc" id="L107">        .setFilter(Texture.TextureFilter.Linear, Texture.TextureFilter.Linear);</span>

<span class="nc" id="L109">    spriteM = ComponentMapper.getFor(SpriteComponent.class);</span>
<span class="nc" id="L110">    transformM = ComponentMapper.getFor(TransformComponent.class);</span>
<span class="nc" id="L111">    animM = ComponentMapper.getFor(AnimationComponent.class);</span>
<span class="nc" id="L112">    timerM = ComponentMapper.getFor(TimerComponent.class);</span>
<span class="nc" id="L113">    attendM = ComponentMapper.getFor(AttendanceCheckerComponent.class);</span>

<span class="nc" id="L115">    this.messageListener = new MessageListener(publisher);</span>
<span class="nc" id="L116">  }</span>

  /**
   * When this is enabled, displays additional visuals to help with debugging. This shows where the
   * origins of each visible objects are and shows colliders for physics entities
   *
   * @param debugWorld The physics world to display colliders for
   */
  public void enableDebugging(World debugWorld) {
<span class="nc" id="L125">    this.isDebugging = true;</span>
<span class="nc" id="L126">    this.debugRenderer = new Box2DDebugRenderer();</span>
<span class="nc" id="L127">    this.debugWorld = debugWorld;</span>
<span class="nc" id="L128">    this.originTexture = game.getAssetLoader().get(AssetId.ORIGIN_INDICATOR, Texture.class);</span>
<span class="nc" id="L129">  }</span>

  @Override
  public void update(float deltaTime) {
<span class="nc" id="L133">    consumeMessages(deltaTime);</span>

<span class="nc" id="L135">    forceSort();</span>

<span class="nc" id="L137">    worldCamera.update();</span>
<span class="nc" id="L138">    mapRenderer.setView(worldCamera);</span>

    // Background
<span class="nc" id="L141">    mapRenderer.render(new int[] {0});</span>

    // World entities
<span class="nc" id="L144">    worldBatch.setProjectionMatrix(worldCamera.combined);</span>
<span class="nc" id="L145">    worldBatch.begin();</span>
<span class="nc" id="L146">    super.update(deltaTime);</span>
<span class="nc" id="L147">    worldBatch.end();</span>

    // Foreground
<span class="nc" id="L150">    mapRenderer.render(new int[] {1});</span>

    // Debug
<span class="nc bnc" id="L153" title="All 2 branches missed.">    if (isDebugging) {</span>
<span class="nc" id="L154">      debugRenderer.render(this.debugWorld, worldCamera.combined);</span>
    }

    // UI
<span class="nc" id="L158">    renderUI();</span>
<span class="nc" id="L159">  }</span>

  /** Process all the new messages it receives */
  private void consumeMessages(float deltaTime) {
<span class="nc bnc" id="L163" title="All 2 branches missed.">    while (messageListener.hasNext()) {</span>
<span class="nc" id="L164">      Message m = messageListener.next();</span>
<span class="nc bnc" id="L165" title="All 2 branches missed.">      if (m.type == MessageType.TOAST_SHOW) {</span>
<span class="nc" id="L166">        ToastMessage t = (ToastMessage) m;</span>
<span class="nc bnc" id="L167" title="All 2 branches missed.">        if (!toasts.contains(t)) {</span>
<span class="nc" id="L168">          toasts.add(t);</span>
        }
<span class="nc bnc" id="L170" title="All 2 branches missed.">        if (toasts.size() &gt; maxNumToasts) {</span>
<span class="nc" id="L171">          toasts.remove(0);</span>
        }
      }
<span class="nc" id="L174">    }</span>

<span class="nc bnc" id="L176" title="All 2 branches missed.">    for (int i = 0; i &lt; toasts.size(); i++) { // remove expired toasts</span>
<span class="nc" id="L177">      ToastMessage t = toasts.get(i);</span>
<span class="nc bnc" id="L178" title="All 2 branches missed.">      if (t.getDurationLeft() &lt;= 0) {</span>
<span class="nc" id="L179">        toasts.remove(t);</span>
      } else {
<span class="nc" id="L181">        t.lowerDuration(deltaTime);</span>
      }
    }
<span class="nc" id="L184">  }</span>

  @Override
  protected void processEntity(Entity entity, float deltaTime) {
<span class="nc" id="L188">    SpriteComponent sprite = spriteM.get(entity);</span>
<span class="nc" id="L189">    TransformComponent transform = transformM.get(entity);</span>
<span class="nc bnc" id="L190" title="All 2 branches missed.">    if (!sprite.isShown) return;</span>

    TextureRegion region;
<span class="nc" id="L193">    AnimationComponent anim = animM.get(entity);</span>
<span class="nc bnc" id="L194" title="All 4 branches missed.">    if (anim != null &amp;&amp; anim.currentFrame != null) {</span>
<span class="nc" id="L195">      region = anim.currentFrame;</span>
    } else {
<span class="nc" id="L197">      region = new TextureRegion(sprite.texture);</span>
    }

<span class="nc" id="L200">    float width = sprite.size.x * transform.scale.x;</span>
<span class="nc" id="L201">    float height = sprite.size.y * transform.scale.y;</span>
<span class="nc" id="L202">    float xOffset = -0.5f * width;</span>

<span class="nc" id="L204">    worldBatch.draw(</span>
        region,
        transform.position.x + sprite.textureOffset.x + xOffset,
        transform.position.y + sprite.textureOffset.y,
        width,
        height);

<span class="nc bnc" id="L211" title="All 2 branches missed.">    if (isDebugging)</span>
<span class="nc" id="L212">      worldBatch.draw(</span>
          originTexture, transform.position.x - 0.5f, transform.position.y - 0.5f, 1f, 1f);
<span class="nc" id="L214">  }</span>

  /**
   * UI refers to the overlay of anything that does not exist in the game world but should be
   * rendered. Renders the timer and toasts.
   */
  private void renderUI() {
<span class="nc" id="L221">    uiViewport.apply();</span>
<span class="nc" id="L222">    shapeRenderer.setProjectionMatrix(uiViewport.getCamera().combined);</span>
<span class="nc" id="L223">    uiBatch.setProjectionMatrix(uiViewport.getCamera().combined);</span>

<span class="nc" id="L225">    ImmutableArray&lt;Entity&gt; timers =</span>
<span class="nc" id="L226">        getEngine().getEntitiesFor(Family.all(TimerComponent.class).get());</span>

<span class="nc bnc" id="L228" title="All 2 branches missed.">    if (timers.size() == 0) return;</span>

<span class="nc" id="L230">    Entity timerEntity = timers.first();</span>
<span class="nc" id="L231">    TimerComponent timer = timerM.get(timerEntity);</span>

<span class="nc" id="L233">    Entity attendanceCheckerEntity =</span>
<span class="nc" id="L234">        getEngine().getEntitiesFor(Family.all(AttendanceCheckerComponent.class).get()).first();</span>
<span class="nc" id="L235">    AttendanceCheckerComponent attendanceChecker = attendM.get(attendanceCheckerEntity);</span>

<span class="nc" id="L237">    float w = uiViewport.getWorldWidth();</span>
<span class="nc" id="L238">    float h = uiViewport.getWorldHeight();</span>

<span class="nc" id="L240">    float centerX = w * 0.5f;</span>
<span class="nc" id="L241">    float centerY = h - 60f;</span>
<span class="nc" id="L242">    float radius = 50f;</span>

<span class="nc" id="L244">    float progressTimer = timer.timeRemaining / timer.totalTime;</span>
<span class="nc" id="L245">    Color barColorTimer = getTimerColor(progressTimer);</span>

<span class="nc" id="L247">    float progressAttendance = attendanceChecker.calculateAttendance();</span>
<span class="nc" id="L248">    Color barColorAttendance = getTimerColor(progressAttendance);</span>

    // Timer background
<span class="nc" id="L251">    shapeRenderer.begin(ShapeRenderer.ShapeType.Filled);</span>
<span class="nc" id="L252">    shapeRenderer.setColor(0.2f, 0.2f, 0.2f, 0.7f);</span>
<span class="nc" id="L253">    shapeRenderer.circle(centerX, centerY, radius);</span>
<span class="nc" id="L254">    shapeRenderer.end();</span>

<span class="nc" id="L256">    shapeRenderer.begin(ShapeRenderer.ShapeType.Filled);</span>
<span class="nc" id="L257">    shapeRenderer.setColor(barColorTimer);</span>
<span class="nc" id="L258">    float arcAngle = progressTimer * 360f;</span>
<span class="nc" id="L259">    shapeRenderer.arc(centerX, centerY, radius - 5f, 90f, arcAngle, 30);</span>
<span class="nc" id="L260">    shapeRenderer.end();</span>

    // Timer ring
<span class="nc" id="L263">    Gdx.gl.glLineWidth(3);</span>
<span class="nc" id="L264">    shapeRenderer.begin(ShapeRenderer.ShapeType.Line);</span>
<span class="nc" id="L265">    shapeRenderer.setColor(0.5f, 0.5f, 0.5f, 1f);</span>
<span class="nc" id="L266">    shapeRenderer.circle(centerX, centerY, radius);</span>
<span class="nc" id="L267">    shapeRenderer.end();</span>
<span class="nc" id="L268">    Gdx.gl.glLineWidth(1);</span>

    // Attendance background
<span class="nc" id="L271">    shapeRenderer.begin(ShapeRenderer.ShapeType.Filled);</span>
<span class="nc" id="L272">    shapeRenderer.setColor(0.2f, 0.2f, 0.2f, 0.7f);</span>
<span class="nc" id="L273">    shapeRenderer.circle(centerX - radius * 3, centerY, radius);</span>
<span class="nc" id="L274">    shapeRenderer.end();</span>

<span class="nc" id="L276">    shapeRenderer.begin(ShapeRenderer.ShapeType.Filled);</span>
<span class="nc" id="L277">    shapeRenderer.setColor(barColorAttendance);</span>
<span class="nc" id="L278">    arcAngle = progressAttendance * 360f; // update</span>
<span class="nc" id="L279">    shapeRenderer.arc(centerX - radius * 3, centerY, radius - 5f, 90f, arcAngle, 30);</span>
<span class="nc" id="L280">    shapeRenderer.end();</span>

    // Attendance ring
<span class="nc" id="L283">    Gdx.gl.glLineWidth(3);</span>
<span class="nc" id="L284">    shapeRenderer.begin(ShapeRenderer.ShapeType.Line);</span>
<span class="nc" id="L285">    shapeRenderer.setColor(0.5f, 0.5f, 0.5f, 1f);</span>
<span class="nc" id="L286">    shapeRenderer.circle(centerX, centerY, radius);</span>
<span class="nc" id="L287">    shapeRenderer.end();</span>
<span class="nc" id="L288">    Gdx.gl.glLineWidth(1);</span>

<span class="nc bnc" id="L290" title="All 2 branches missed.">    for (int i = 0; i &lt; toasts.size(); i++) {</span>
<span class="nc" id="L291">      drawToastBackground(toasts.get(i));</span>
    }

    // Scale fonts relative to current viewport
<span class="nc" id="L295">    timerFont.getData().setScale(2f * h / Gdx.graphics.getHeight());</span>
<span class="nc" id="L296">    toastFont.getData().setScale(2f * h / Gdx.graphics.getHeight());</span>

<span class="nc" id="L298">    uiBatch.begin();</span>

    // Timer text
<span class="nc" id="L301">    int minutes = (int) (timer.timeRemaining / 60);</span>
<span class="nc" id="L302">    int seconds = (int) (timer.timeRemaining % 60);</span>
<span class="nc" id="L303">    String timeText = String.format(&quot;%02d:%02d&quot;, minutes, seconds);</span>
<span class="nc" id="L304">    GlyphLayout timeLayout = new GlyphLayout(timerFont, timeText);</span>
<span class="nc" id="L305">    timerFont.draw(</span>
        uiBatch, timeLayout, centerX - timeLayout.width * 0.5f, centerY + timeLayout.height * 0.5f);

    // Attendance Text
<span class="nc" id="L309">    String attendText = String.valueOf((int) (attendanceChecker.calculateAttendance() * 100)) + &quot;%&quot;;</span>
<span class="nc" id="L310">    GlyphLayout attendLayout = new GlyphLayout(timerFont, attendText);</span>
<span class="nc" id="L311">    timerFont.draw(</span>
        uiBatch,
        attendLayout,
        centerX - timeLayout.width / 3 - radius * 3,
        centerY + timeLayout.height * 0.5f);
<span class="nc bnc" id="L316" title="All 2 branches missed.">    for (int i = 0; i &lt; toasts.size(); i++) {</span>
<span class="nc" id="L317">      drawToastText(toasts.get(i));</span>
    }
    
    // Rasperry Pi Display
    Texture piDisplay;
<span class="nc bnc" id="L322" title="All 6 branches missed.">    switch (PiSystem.getSlicesCollected()) {</span>
        case 1 -&gt; {
<span class="nc" id="L324">          piDisplay = game.getAssetLoader().get(AssetId.PI_1, Texture.class);</span>
<span class="nc" id="L325">        }</span>
        case 2 -&gt; {
<span class="nc" id="L327">          piDisplay = game.getAssetLoader().get(AssetId.PI_2, Texture.class);</span>
<span class="nc" id="L328">        }</span>
        case 3 -&gt; {
<span class="nc" id="L330">          piDisplay = game.getAssetLoader().get(AssetId.PI_3, Texture.class);</span>
<span class="nc" id="L331">        }</span>
        case 4 -&gt; {
<span class="nc" id="L333">          piDisplay = game.getAssetLoader().get(AssetId.PI_4, Texture.class);</span>
<span class="nc" id="L334">        }</span>
        case 5 -&gt; {
<span class="nc" id="L336">          piDisplay = game.getAssetLoader().get(AssetId.PI_5, Texture.class);</span>
<span class="nc" id="L337">        }</span>
        default -&gt; {
<span class="nc" id="L339">          piDisplay = game.getAssetLoader().get(AssetId.PI_0, Texture.class);</span>
          
        }
    }
<span class="nc" id="L343">    uiBatch.draw(piDisplay, w/4, h/8, 128, 128);</span>

<span class="nc" id="L345">    uiBatch.end();</span>
<span class="nc" id="L346">  }</span>

  // ---------- Toast helpers ----------

  /** Draws a panel to go behind any toasts */
  private void drawToastBackground(ToastMessage t) {
<span class="nc bnc" id="L352" title="All 4 branches missed.">    if (t.getDurationLeft() &lt;= 0f || t.getText() == null) return;</span>
<span class="nc" id="L353">    float toastTimeRemaining = t.getDurationLeft();</span>
<span class="nc" id="L354">    String toastText = t.getText();</span>
<span class="nc" id="L355">    float toastOffsetY = toasts.indexOf(t) * toastSpacing;</span>

<span class="nc bnc" id="L357" title="All 2 branches missed.">    float alpha = (toastTimeRemaining &gt; 0.3f) ? 1f : (toastTimeRemaining / 0.3f);</span>

<span class="nc" id="L359">    float w = uiViewport.getWorldWidth();</span>
<span class="nc" id="L360">    float h = uiViewport.getWorldHeight();</span>

<span class="nc" id="L362">    GlyphLayout layout = new GlyphLayout(toastFont, toastText);</span>

<span class="nc" id="L364">    float x = (w - layout.width) * 0.5f;</span>
<span class="nc" id="L365">    float y = h - 140f - toastOffsetY;</span>

<span class="nc" id="L367">    float padding = 28f;</span>
<span class="nc" id="L368">    float bgWidth = layout.width + padding * 2f;</span>
<span class="nc" id="L369">    float bgHeight = layout.height + padding * 1.5f;</span>

    // Rounded capsule radius
<span class="nc" id="L372">    float radius = bgHeight * 0.5f;</span>

<span class="nc" id="L374">    float bgX = x - padding;</span>
<span class="nc" id="L375">    float bgY = y - layout.height - padding * 0.75f;</span>

    // Background color
<span class="nc" id="L378">    Color backColour = new Color();</span>
<span class="nc" id="L379">    backColour.set(t.getBackColour(), 0.85f * alpha);</span>

<span class="nc" id="L381">    shapeRenderer.begin(ShapeRenderer.ShapeType.Filled);</span>
<span class="nc" id="L382">    shapeRenderer.setColor(backColour);</span>

    // Center rectangle
<span class="nc" id="L385">    shapeRenderer.rect(bgX + radius, bgY, bgWidth - 2 * radius, bgHeight);</span>

    // Left cap
<span class="nc" id="L388">    shapeRenderer.arc(bgX + radius, bgY + radius, radius, 90, 180);</span>

    // Right cap
<span class="nc" id="L391">    shapeRenderer.arc(bgX + bgWidth - radius, bgY + radius, radius, 270, 180);</span>

<span class="nc" id="L393">    shapeRenderer.end();</span>
<span class="nc" id="L394">  }</span>

  /**
   * Displays the text of the &quot;toast&quot;, displaying information about the state of the game to the
   * player
   */
  private void drawToastText(ToastMessage t) {
<span class="nc bnc" id="L401" title="All 4 branches missed.">    if (t.getDurationLeft() &lt;= 0f || t.getText() == null) return;</span>
<span class="nc" id="L402">    float toastTimeRemaining = t.getDurationLeft();</span>
<span class="nc" id="L403">    String toastText = t.getText();</span>
<span class="nc" id="L404">    float toastOffsetY = toasts.indexOf(t) * toastSpacing;</span>

<span class="nc bnc" id="L406" title="All 2 branches missed.">    float alpha = (toastTimeRemaining &gt; 0.3f) ? 1f : (toastTimeRemaining / 0.3f);</span>

<span class="nc" id="L408">    float w = uiViewport.getWorldWidth();</span>
<span class="nc" id="L409">    float h = uiViewport.getWorldHeight();</span>

<span class="nc" id="L411">    GlyphLayout layout = new GlyphLayout(toastFont, toastText);</span>

<span class="nc" id="L413">    float x = (w - layout.width) * 0.5f;</span>
<span class="nc" id="L414">    float y = h - 140f - toastOffsetY;</span>

    // Shadow
<span class="nc" id="L417">    toastFont.setColor(0f, 0f, 0f, 0.5f * alpha);</span>
<span class="nc" id="L418">    toastFont.draw(uiBatch, layout, x + 2f, y - 2f);</span>

    // Text
<span class="nc" id="L421">    toastFont.setColor(new Color().set(t.getTextColour(), alpha));</span>
<span class="nc" id="L422">    toastFont.draw(uiBatch, layout, x, y);</span>
<span class="nc" id="L423">  }</span>

  private Color getTimerColor(float progress) {
<span class="nc" id="L426">    Color green = new Color(0.2f, 0.8f, 0.2f, 1f);</span>
<span class="nc" id="L427">    Color yellow = new Color(1f, 0.8f, 0f, 1f);</span>
<span class="nc" id="L428">    Color red = new Color(1f, 0.2f, 0.2f, 1f);</span>

<span class="nc bnc" id="L430" title="All 2 branches missed.">    if (progress &gt; 0.5f) {</span>
<span class="nc" id="L431">      float t = (progress - 0.5f) / 0.5f;</span>
<span class="nc" id="L432">      return green.cpy().lerp(yellow, 1f - t);</span>
    } else {
<span class="nc" id="L434">      float t = progress / 0.5f;</span>
<span class="nc" id="L435">      return yellow.cpy().lerp(red, 1f - t);</span>
    }
  }

  public void resize(int width, int height) {
<span class="nc" id="L440">    uiViewport.update(width, height, true);</span>
<span class="nc" id="L441">  }</span>

  public void dispose() {
<span class="nc bnc" id="L444" title="All 2 branches missed.">    if (isDebugging) {</span>
<span class="nc" id="L445">      debugRenderer.dispose();</span>
    }
<span class="nc" id="L447">  }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.13.202504020838</span></div></body></html>